\documentclass[a4paper, 12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{bookmark}

\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{enumitem}
%\usepackage{gensymb}
\usepackage{array}
\usepackage[T1]{fontenc}
\usepackage{bbold}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{color}
\usepackage{hyperref}
\usepackage[margin=2cm]{geometry}

\usepackage{float}
\usepackage{subcaption}
\usepackage{comment}
\usepackage[table, xcdraw, dvipsnames]{xcolor}
\usepackage{multirow}

\usepackage{multicol}
\usepackage{empheq}
\usepackage{lscape}
\usepackage{tabto}

% \usepackage[backend=biber,sorting=none]{biblatex}
% \addbibresource{Ref.bib}
% \nocite{*}

\title{Data assimilation as Simulation-based inference}

\author{ANDRY Gérôme (s182909)}

\date{Academic year 2022-2023}

\begin{document}

\maketitle

\newpage
\section*{Abstract}
\input{sections/Abstract.tex}

\newpage
\section*{Acknowledgements}

\newpage
\tableofcontents
\newpage


\section{Introduction}
\subsection{Inverse problem and data assimilation}
\input{sections/InvProb.tex}
% General purpose (from which SBI is in)
% Speak about linear/non-linear problem, data-dependent noise, ... 
% And specify the setup of this thesis
% 4D Var, ... 
\subsection{Problem statement}

\section{SBI framework}
\subsection{Introduction}
Frontier SBI + packages (nflows Cranmer, lampe, zuko, ... ?), Bayes, ...
\subsection{Neural posterior estimation}
\subsubsection{Normalizing flows}
\subsection{Neural ratio estimation}
\subsubsection{Classifier networks}
\subsection{Neural score estimation}
\subsubsection{Score-based models}

\section{Application to data assimilation problems}
\subsection{Assumptions}
Simulator, pairs x/y, no prior knowledge on $p(x_0)$ at first or at least no close form of marginals,
general black-box observator (then, unwarp -> linear), high dimensionality,
spatial structure, ... TIME embed -> no ass about stationarity of density (mention FR work)

\subsection{NPE}
speak here about Multi scale flow
Do not work well but try other flow ... ?
\subsection{NRE}
speak here about state density 
\subsection{NSE}
novel method, high dimensionality expectation, domain generalization
-> Linear or not (develop both formulae)
Linear : Good to train 1 network no matter the observations (and adapt to observations). In this 
setup, we could imagine having a linear temporal observator $y(t) = A_t x_t + \eta$
\section{Experiments}
\subsection{Evaluation protocol}
Add a word about architectures in appendix.
Training + validation on WndB, then evaluation 
Corner plot (comparison between methods) posterior along time marginal (reduce uncertainty)
-> For both samples and observations (with the true observator but samples observed)
Samples (qualitative -> mainly for 2D problem, hard for 1D)
Loss (link between NSE and NPE ?) -> Explain both losses and develop log prob for NSE 

Mainly, physical and observation coherence 
-> use of a classifier that is shared among models and that discriminates between true and fake samples 
(need positional and time embedding in order to give spatial coherence)
(develop how to perform the classification for observations)
remember $p(x_t|y_t,t)$ so one has class = $p(X = true|y_t, t)$
\subsubsection{Corner plot}
\subsubsection{Discriminator network}
As in GAN 
\subsubsection{Qualitative assessment}
\subsubsection{Temporal consistency}
Qualitative, better with assimilation window, but problems inherent to the method.
-> Mention François and HMM


\subsection{Simulators}
\subsubsection{Lorenz-96}
\subsubsection{2D Kolmogorov flow}
\subsection{Observator}
\subsection{Results}

\section{Conclusion}
Real world problem ... ? 
Probabilistic model !
\section{References}

\end{document}